<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8" />
<title>04</title>

<link rel="stylesheet" href="../../../style.css" type="text/css" />

<link rel="stylesheet" href="../../../local.css" type="text/css" />







</head>
<body>

<article class="page">

<section class="pageheader">
<header class="header">
<span>
<span class="parentlinks">

<a href="../../../">Rogério Brito's Digital Junkyard</a>/

<a href="../../">archives</a>/

<a href="../">2013</a>/

</span>
<span class="title">
04

</span>
</span>

</header>







</section>


<aside class="sidebar">


<div><div class="calendar"><table class="month-calendar">
    <tr>
    <th class="month-calendar-arrow"><a href="../03/" title="March">&larr;</a></th>
    <th class="month-calendar-head" colspan="5"><span class="selflink">Apr 2013</span></th>
    <th class="month-calendar-arrow"><a href="../05/" title="May">&rarr;</a></th>
    </tr>
    <tr>
        <th class="month-calendar-day-head Sunday" title="Sunday">S</th>
        <th class="month-calendar-day-head Monday" title="Monday">M</th>
        <th class="month-calendar-day-head Tuesday" title="Tuesday">T</th>
        <th class="month-calendar-day-head Wednesday" title="Wednesday">W</th>
        <th class="month-calendar-day-head Thursday" title="Thursday">T</th>
        <th class="month-calendar-day-head Friday" title="Friday">F</th>
        <th class="month-calendar-day-head Saturday" title="Saturday">S</th>
    </tr>
    <tr>
        <td class="month-calendar-day-noday Sunday">&nbsp;</td>
        <td class="month-calendar-day-nolink Monday">1</td>
        <td class="month-calendar-day-nolink Tuesday">2</td>
        <td class="month-calendar-day-nolink Wednesday">3</td>
        <td class="month-calendar-day-nolink Thursday">4</td>
        <td class="month-calendar-day-nolink Friday">5</td>
        <td class="month-calendar-day-nolink Saturday">6</td>
    </tr>
    <tr>
        <td class="month-calendar-day-nolink Sunday">7</td>
        <td class="month-calendar-day-nolink Monday">8</td>
        <td class="month-calendar-day-nolink Tuesday">9</td>
        <td class="month-calendar-day-nolink Wednesday">10</td>
        <td class="month-calendar-day-nolink Thursday">11</td>
        <td class="month-calendar-day-nolink Friday">12</td>
        <td class="month-calendar-day-nolink Saturday">13</td>
    </tr>
    <tr>
        <td class="month-calendar-day-nolink Sunday">14</td>
        <td class="month-calendar-day-nolink Monday">15</td>
        <td class="month-calendar-day-nolink Tuesday">16</td>
        <td class="month-calendar-day-nolink Wednesday">17</td>
        <td class="month-calendar-day-nolink Thursday">18</td>
        <td class="month-calendar-day-link Friday"><div class='popup'>19<div class='balloon'><ul>
            <li><a href="../../../posts/debian_activities/" title="Some recent Debian activities">Some recent Debian activities</a></li>
            <li><a href="../../../posts/lack_of_cooperation_from_ubuntu/" title="Lack of cooperation from Ubuntu?">Lack of cooperation from Ubuntu?</a></li>
        </ul></div></div></td>
        <td class="month-calendar-day-nolink Saturday">20</td>
    </tr>
    <tr>
        <td class="month-calendar-day-nolink Sunday">21</td>
        <td class="month-calendar-day-nolink Monday">22</td>
        <td class="month-calendar-day-nolink Tuesday">23</td>
        <td class="month-calendar-day-nolink Wednesday">24</td>
        <td class="month-calendar-day-nolink Thursday">25</td>
        <td class="month-calendar-day-nolink Friday">26</td>
        <td class="month-calendar-day-nolink Saturday">27</td>
    </tr>
    <tr>
        <td class="month-calendar-day-nolink Sunday">28</td>
        <td class="month-calendar-day-nolink Monday">29</td>
        <td class="month-calendar-day-nolink Tuesday">30</td>
        <td class="month-calendar-day-noday Wednesday">&nbsp;</td>
        <td class="month-calendar-day-noday Thursday">&nbsp;</td>
        <td class="month-calendar-day-noday Friday">&nbsp;</td>
        <td class="month-calendar-day-noday Saturday">&nbsp;</td>
    </tr>
</table>
</div></div>


</aside>


<div id="pagebody">

<section id="content">


<article class="inlinepage">

<section class="inlineheader">

<header class="header">

<a href="../../../posts/debian_activities/">Some recent Debian activities</a>

</header>
</section>

<section class="inlinecontent">
<p>I have been occasionally working on some Debian-related tasks.</p>

<h1>Chrony</h1>

<p>One of those was to get chrony is a slightly better shape, by using, at
least, a patch system (indeed, I "modernized" its packaging with the format
"3.0 (quilt)"), put it in <a href="http://anonscm.debian.org/gitweb/?p=users/rbrito-guest/chrony.git">a git repository</a> and would like to receive some
comments on what I have so far.</p>

<p>The bug <a href="http://bugs.debian.org/694690">Debian bug #694690</a> contains a very brief description of my
intentions and of the problems that I see in the current package. IMVHO, it
is a very nice NTP client and server and it could even be used as the
default for Debian, once it gets in shape.  There is at least another
high-profile distribution, namely Fedora, that
<a href="http://fedoraproject.org/wiki/Features/ChronyDefaultNTP">switched to chrony as its default NTP software</a>. We can certainly take a
look at what they are doing and join forces here.</p>

<h1>MongoDB</h1>

<p>Another package where I spent some time was with <a href="http://packages.qa.debian.org/mongodb">mongodb</a>:
MongoDB is a tricky package that is only built for 2 arches: amd64 and
i386.  The version in unstable for i386 was 2.0.x (roughly the same as for
wheezy), which the version in unstable for amd64 was 2.4.1, which has many
features that 2.0 lacks.</p>

<p>The packaging of it is a bit tricky, since the source tree has bazillion
embedded/convenience libraries (e.g., Google's v8, Mozilla's spidermonkey,
BOOST, Google's Snappy, PCRE 3 etc.). Up to version 2.4.1-2, it used all
these convenience copies, which is of course, a problem for a distribution
like Debian.</p>

<p><a href="http://packages.qa.debian.org/m/mongodb/news/20130417T171917Z.html">I changed</a> part of the build process to use the libraries that we
already have in Debian and, as Antonin Kral uploaded this newer version,
unsurprisingly the binary packages are smaller (especially if you take into
account that a handful of the libraries may already be installed on the
system).</p>

<p>A few hours later, Antonin uploaded a new upstream version, which means that
we now have better MongoDB packages to play with.  I am, in fact, really
playing with MongoDB as my first NoSQL database, since
<a href="https://education.10gen.com/courses/10gen/M101/2012_Fall/about">10gen is giving an introductory course</a> on how it works and my
motivation was to get what we have in Debian in shape for the course.</p>

<p>You can say that I am a firm believer of the "eat your own dogfood"
principle.</p>

<p>Regarding MongoDB only being built for i386 and amd64, the BTS
<a href="http://bugs.debian.org/703061">has a patch</a> to enable building for kFreeBSD, but the patch is for the
2.0 series and the code has changed so drastically in relation to the 2.4
series that there is no hope of it applying.  It would be super nice to have
MongoDB working on kFreeBSD and on HURD also, though.</p>

<h1>nocache</h1>

<p>There is a very nice command line program called <code>nocache</code> that was packaged
by Dmitry Smirnov (and just approved by the FTP masters!) whose packaging I
briefly reviewed per Dmitry's request and this is an amazing utility whose
purpose is to bypass/minimize file system caching for a program.</p>

<p>This is especially useful when you are making backups (reading lots of files
that would, otherwise, fill the filesystem cache, even if they are not used
frequently) or if you are just streaming one file (possibly larger than the
system's RAM) to another computer and you have no need to use the file
immediately after that.</p>

<p>It performs its job by using the <code>LD_PRELOAD</code> mechanism and using
<code>posix_fadvise</code>'s flag <code>POSIX_FADV_DONTNEED</code> for the files that will be
touched.</p>

<h1>Post note</h1>

<p>Oh, just one aside: for the readers of Debian Planet and other aggregation
services which are not Debian Developers/Maintainers, I contributed to these
packages without being the maintainer of them, just scratching some itches
and contributing back what I produced.</p>

</section>

<footer class="inlinefooter">

<span class="pagedate">
Posted <time datetime="2013-04-19T07:29:23Z" pubdate="pubdate">2013-04-19T04:29:23 BRT</time>
</span>


<nav class="tags">
Tags:

<a href="../../../tags/debian/" rel="tag">debian</a>

<a href="../../../tags/free-software/" rel="tag">free-software</a>

<a href="../../../tags/linux/" rel="tag">linux</a>

</nav>








</footer>

</article>
<article class="inlinepage">

<section class="inlineheader">

<header class="header">

<a href="../../../posts/lack_of_cooperation_from_ubuntu/">Lack of cooperation from Ubuntu?</a>

</header>
</section>

<section class="inlinecontent">
<p>I <a href="https://plus.google.com/117659222649141007981/posts/C2vY4nD4CD6">posted the following on Google+</a>, but it is important enough to be
reproduced on Planet. I'm editing it a bit, as it is a followup to my
previous post.</p>

<p>While <a href="http://cynic.cc/blog/posts/debian_activities/">improving the packaging of MongoDB</a>, there was one thing that
caught my attention: that Ubuntu
<a href="http://changelogs.ubuntu.com/changelogs/pool/universe/m/mongodb/mongodb_2.0.4-1ubuntu2.1/changelog">had already done some of the embedded/convenience libraries work</a>, but
they had <em>not</em> pushed that work to Debian.</p>

<p>Of course, discovered this only after I started working on the improvements
of the package.</p>

<p><strong>What gives, Ubuntu people?</strong></p>

<p>Another thing that I saw is that
<a href="https://launchpad.net/ubuntu/+source/mongodb/1:2.2.4-0ubuntu1/+build/4470136">they have patches enabling mongodb working on armhf</a>. Again, they did
<em>not</em> push those to Debian.</p>

<p><strong>Why this lack of cooperation?</strong></p>

<p>Another thing that I saw is that they had packages for version 2.2 (more
precisely, <a href="http://packages.ubuntu.com/raring/mongodb">raring has 1:2.2.4-0ubuntu1</a>), while Debian sid
<a href="http://packages.debian.org/changelogs/pool/main/m/mongodb/mongodb_2.4.1-2/changelog.html">just had 2.0</a> until very recently.</p>

<p><strong>Why not push this work and avoid duplication of work?</strong></p>

<p>By being a good downstream, I intend to push some of the patches to MongoDB
upstream (if they want it), so that we (Debian) have a smaller delta. This
will benefit you Ubuntu guys. Why not join forces and help have a
world-class set of packages?</p>

<p>Please, be good netizens and share the work that you have.  I firmly believe
that the armhf people will be happy to have one of the fancy "cloud"
software available on ARM, especially since the prospects of having ARM
machines on datacenters.</p>

<p>Oh, just for the record, the
<a href="https://github.com/rbrito/mongo-debian/pull/2">kFreeBSD people have sent their contribution</a> and I would love to see
(if possible) this running on the HURD.</p>

</section>

<footer class="inlinefooter">

<span class="pagedate">
Posted <time datetime="2013-04-20T01:46:26Z" pubdate="pubdate">2013-04-19T22:46:26 BRT</time>
</span>


<nav class="tags">
Tags:

<a href="../../../tags/debian/" rel="tag">debian</a>

<a href="../../../tags/free-software/" rel="tag">free-software</a>

<a href="../../../tags/kfreebsd/" rel="tag">kfreebsd</a>

<a href="../../../tags/linux/" rel="tag">linux</a>

<a href="../../../tags/ubuntu/" rel="tag">ubuntu</a>

</nav>








</footer>

</article>





</section>





<div id="comments">

<div id="disqus_comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'digitaljunkyard'; // required: replace example with your forum shortname
    var discus_identifier = 'archives/2013/04';
    var disqus_url = 'http://cynic.cc/blog//archives/2013/04/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

</div>

</div>

<footer id="footer" class="pagefooter">

<nav id="pageinfo">











<div class="pagedate">
Last edited <time datetime="2013-10-11T06:07:42Z">2013-10-11T03:07:42 BRT</time>
<!-- Created <time datetime="2013-10-11T06:07:42Z" pubdate="pubdate">2013-10-11T03:07:42 BRT</time> -->
</div>

</nav>


<!-- from Rogério Brito's Digital Junkyard -->
</footer>

</article>

<!-- MathJax -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- MathJax -->

</body>
</html>
